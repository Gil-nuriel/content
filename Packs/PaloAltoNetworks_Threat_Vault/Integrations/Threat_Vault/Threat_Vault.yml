category: Data Enrichment & Threat Intelligence
commonfields:
  id: Palo Alto Networks Threat Vault
  version: -1
configuration:
- display: API Key
  name: api_key
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Use the Palo Alto Networks Threat Vault to research the latest threats (vulnerabilities/exploits, viruses, and spyware) that Palo Alto Networks next-generation firewalls can detect and prevent.
display: Palo Alto Networks Threat Vault
name: Palo Alto Networks Threat Vault
script:
  commands:
  - arguments:
    - default: false
      description: The query for which to retrieve samples. For additional information on how to build your query using the AF GUI, see the detailed description section.
      isArray: false
      name: query
      required: false
      secret: false
    - default: false
      defaultValue: '30'
      description: The number of results to return.
      isArray: false
      name: max_results
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The field by which to sort the results.
      isArray: false
      name: sort
      predefined:
      - App Name
      - App Packagename
      - File type
      - Size
      - Finish Date
      - First Seen (Create Date)
      - Last Updated (Update Date)
      - MD5
      - SHA1
      - SHA256
      - Ssdeep Fuzzy Hash
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The order of the results. Can be "Ascending" or "Descending".
      isArray: false
      name: order
      predefined:
      - Ascending
      - Descending
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: ' The scope of the search. Can be "Private", "Public", or "Global".'
      isArray: false
      name: scope
      predefined:
      - Private
      - Public
      - Global
      required: true
      secret: false
    - default: false
      description: The MD5, SHA1 or SHA256 hash of the file.
      isArray: false
      name: file_hash
      required: false
      secret: false
    - default: false
      description: The domain to search.
      isArray: false
      name: domain
      required: false
      secret: false
    - default: false
      description: The IP address to search.
      isArray: false
      name: ip
      required: false
      secret: false
    - default: false
      description: The URL to search.
      isArray: false
      name: url
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The Wildfire verdict. Can be "Malware", "Grayware", "Benign", or "Phishing".
      isArray: false
      name: wildfire_verdict
      predefined:
      - Malware
      - Grayware
      - Benign
      - Phishing
      required: false
      secret: false
    - default: false
      description: 'The date range of the creation date. Format: YYY Y-MM-DDTHH:MM:SS,YYYY-MM-DDTHH:MM:SS where the first date is the beginning and the second is the end. Example: 2019-09-09T00:00:00,2019-09-09T23:01:59'
      isArray: false
      name: first_seen
      required: false
      secret: false
    - default: false
      description: 'The date range of the last updated date. Format: YYY Y-MM-DDTHH:MM:SS,YYYY-MM-DDTHH:MM:SS where the first date is the beginning and the second is the end. Example: 2019-09-09T00:00:00,2019-09-09T23:01:59'
      isArray: false
      name: last_updated
      required: false
      secret: false
    - auto: PREDEFINED
      defaultValue: 'true'
      description: 'Whether to return artifacts of samples.'
      isArray: false
      name: artifact
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    deprecated: false
    description: Searches for samples in AutoFocus. To view results, run the autofocus-samples-search-results command with the returned AF Cookie. The AF Cookie expires 120 seconds after the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook is recommended for querying and polling.
    execution: false
    name: autofocus-search-samples
    outputs:
    - contextPath: AutoFocus.SamplesSearch.AFCookie
      description: The AutoFocus search ID. Use this ID to retrieve search results. The AF Cookie expires 120 seconds after the search completes.
      type: String
    - contextPath: AutoFocus.SamplesSearch.Status
      description: The search status. Can be "in progress" or "complete".
      type: String
    - contextPath: AutoFocus.SamplesSearch.SessionStart
      description: The time when the session began.
      type: Date
  dockerimage: demisto/python3:3.8.6.12176
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No test
fromversion: 5.0.0
